using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace Divuvina.Controllers
{
    public class QuanLyXeController : Controller
    {
        Models.dbContext _db = new Models.dbContext();

        // GET: QuanLyXe
        public ActionResult Index()
        {
            return View();
        }

        #region DanhMucLoaiXe
        public ActionResult DanhMucLoaiXe()
        {
            return View();
        }

        public JsonResult GetDataDanhMucLoaiXe()
        {
            var rs = _db.LoaiXes.Select(r => new { Key = r.LoaiXeKey, r.Ten, r.MoTa, r.HangSanXuat, r.Model, r.MayChayDau, r.MayChayXang, r.SoGhe, r.LoaiGhe, r.GhiChu });
            return Json(rs, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        public JsonResult DeleteDanhMucLoaiXe(int Key)
        {
            try
            {
                var row = _db.LoaiXes.FirstOrDefault(r => r.LoaiXeKey == Key);
                if (row != null)
                {
                    _db.LoaiXes.Remove(row);
                    _db.SaveChanges();
                }

                return Json(new { Result = true, Title = "Thông báo !", Message = "Thao tác dữ liệu thành công !" }, JsonRequestBehavior.AllowGet);
            }
            catch (Exception)
            {
                return Json(new { Result = false, Title = "Thông báo !", Message = "Thao tác dữ liệu không thành công !" }, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpPost]
        public ActionResult SaveDanhMucLoaiXe(int Key, string Ten, string MoTa, string HangSanXuat, string Model
            , bool MayChayDau
            , bool MayChayXang
            , short SoGhe
            , string LoaiGhe
            , string GhiChu)
        {
            try
            {
                var row = _db.LoaiXes.FirstOrDefault(r => r.LoaiXeKey == Key);
                if (row == null)
                {
                    row = new Models.LoaiXe();
                    row.LoaiXeAlternateKey = Key.ToString();
                    _db.LoaiXes.Add(row);
                }
                row.Ten = Ten;
                row.MoTa = MoTa;
                row.HangSanXuat = HangSanXuat;
                row.Model = Model;
                row.MayChayDau = MayChayDau;
                row.MayChayXang = MayChayXang;
                row.SoGhe = SoGhe;
                row.LoaiGhe = LoaiGhe;
                row.GhiChu = GhiChu;

                _db.SaveChanges();

                return Json(new { Result = true, Title = "Thông báo !", Message = "Thao tác dữ liệu thành công !" }, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Result = false, Title = "Thông báo !", Message = "Thao tác dữ liệu không thành công !" }, JsonRequestBehavior.AllowGet);
            }
        }
        #endregion DanhMucLoaiXe

        #region DanhMucNoiSuaChuaXe
        public ActionResult DanhMucNoiSuaChuaXe()
        {
            return View();
        }

        public JsonResult GetDataDanhMucNoiSuaChuaXe()
        {
            var rs = _db.NoiSuaChuaXes.Select(r => new { Key = r.NoiSuaChuaXeKey, r.Ten, r.DiaChi, r.GhiChu });
            return Json(rs, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        public JsonResult DeleteDanhMucNoiSuaChuaXe(int Key)
        {
            try
            {
                var row = _db.NoiSuaChuaXes.FirstOrDefault(r => r.NoiSuaChuaXeKey == Key);
                if (row != null)
                {
                    _db.NoiSuaChuaXes.Remove(row);
                    _db.SaveChanges();
                }

                return Json(new { Result = true, Title = "Thông báo !", Message = "Thao tác dữ liệu thành công !" }, JsonRequestBehavior.AllowGet);
            }
            catch (Exception)
            {
                return Json(new { Result = false, Title = "Thông báo !", Message = "Thao tác dữ liệu không thành công !" }, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpPost]
        public ActionResult SaveDanhMucNoiSuaChuaXe(int Key, string Ten, string DiaChi, string GhiChu)
        {
            try
            {
                var row = _db.NoiSuaChuaXes.FirstOrDefault(r => r.NoiSuaChuaXeKey == Key);
                if (row == null)
                {
                    row = new Models.NoiSuaChuaXe();
                    row.NoiSuaChuaXeAlternateKey = Key.ToString();
                    _db.NoiSuaChuaXes.Add(row);
                }
                row.Ten = Ten;
                row.DiaChi = DiaChi;
                row.GhiChu = GhiChu;

                _db.SaveChanges();

                return Json(new { Result = true, Title = "Thông báo !", Message = "Thao tác dữ liệu thành công !" }, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Result = false, Title = "Thông báo !", Message = "Thao tác dữ liệu không thành công !" }, JsonRequestBehavior.AllowGet);
            }
        }
        #endregion DanhMucNoiSuaChuaXe

        #region DanhMucThietBiLinhKien
        public ActionResult DanhMucThietBiLinhKien()
        {
            return View();
        }

        public JsonResult GetDataDanhMucThietBiLinhKien()
        {
            var rs = _db.ThietBiLinhKiens.Select(r => new { Key = r.ThietBiLinhKienKey, r.Ten, r.HangSanXuat, r.DienGiai, r.GhiChu });
            return Json(rs, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        public JsonResult DeleteDanhMucThietBiLinhKien(int Key)
        {
            try
            {
                var row = _db.ThietBiLinhKiens.FirstOrDefault(r => r.ThietBiLinhKienKey == Key);
                if (row != null)
                {
                    _db.ThietBiLinhKiens.Remove(row);
                    _db.SaveChanges();
                }

                return Json(new { Result = true, Title = "Thông báo !", Message = "Thao tác dữ liệu thành công !" }, JsonRequestBehavior.AllowGet);
            }
            catch (Exception)
            {
                return Json(new { Result = false, Title = "Thông báo !", Message = "Thao tác dữ liệu không thành công !" }, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpPost]
        public ActionResult SaveDanhMucThietBiLinhKien(int Key, string Ten, string HangSanXuat, string DienGiai, string GhiChu)
        {
            try
            {
                var row = _db.ThietBiLinhKiens.FirstOrDefault(r => r.ThietBiLinhKienKey == Key);
                if (row == null)
                {
                    row = new Models.ThietBiLinhKien();
                    row.ThietBiLinhKienAlternateKey = Key.ToString();
                    _db.ThietBiLinhKiens.Add(row);
                }
                row.Ten = Ten;
                row.HangSanXuat = HangSanXuat;
                row.DienGiai = DienGiai;
                row.GhiChu = GhiChu;

                _db.SaveChanges();

                return Json(new { Result = true, Title = "Thông báo !", Message = "Thao tác dữ liệu thành công !" }, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Result = false, Title = "Thông báo !", Message = "Thao tác dữ liệu không thành công !" }, JsonRequestBehavior.AllowGet);
            }
        }
        #endregion DanhMucThietBiLinhKien

        #region DanhMucChiPhi
        public ActionResult DanhMucChiPhi()
        {
            return View();
        }

        public JsonResult GetDataDanhMucChiPhi()
        {
            var rs = _db.DanhMucChiPhis.Select(r => new { Key = r.DanhMucChiPhiKey, r.DienGiai, r.GhiChu });
            return Json(rs, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        public JsonResult DeleteDanhMucChiPhi(int Key)
        {
            try
            {
                var row = _db.DanhMucChiPhis.FirstOrDefault(r => r.DanhMucChiPhiKey == Key);
                if (row != null)
                {
                    _db.DanhMucChiPhis.Remove(row);
                    _db.SaveChanges();
                }

                return Json(new { Result = true, Title = "Thông báo !", Message = "Thao tác dữ liệu thành công !" }, JsonRequestBehavior.AllowGet);
            }
            catch (Exception)
            {
                return Json(new { Result = false, Title = "Thông báo !", Message = "Thao tác dữ liệu không thành công !" }, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpPost]
        public ActionResult SaveDanhMucChiPhi(int Key, string DienGiai, string GhiChu)
        {
            try
            {
                var row = _db.DanhMucChiPhis.FirstOrDefault(r => r.DanhMucChiPhiKey == Key);
                if (row == null)
                {
                    row = new Models.DanhMucChiPhi();
                    row.DanhMucChiPhiAlternateKey = Key.ToString();
                    _db.DanhMucChiPhis.Add(row);
                }
                row.DienGiai = DienGiai;
                row.GhiChu = GhiChu;

                _db.SaveChanges();

                return Json(new { Result = true, Title = "Thông báo !", Message = "Thao tác dữ liệu thành công !" }, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Result = false, Title = "Thông báo !", Message = "Thao tác dữ liệu không thành công !" }, JsonRequestBehavior.AllowGet);
            }
        }
        #endregion DanhMucChiPhi
    }//EndClass
}//EndNamespace